<!DOCTYPE html>
<html>

<head>
	<meta name="author" content="Khoa Lam">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width">
	<title> TRUNG TÂM ĐIỀU HÀNH THÔNG MINH TỈNH BÀ RỊA VŨNG TÀU </title>
	<style>

	</style>
</head>

<body>	
	<div id="slideshow" class="slideshow">
	</div>
	<script>
		const SECOND = 30;
		const SLIDE = [
			{
				name: 'KTXH-THU CHI NGÂN SÁCH',
				load: false,
				url: 'https://app.powerbi.com/view?r=eyJrIjoiOGE1NTAzMTUtYmZlYS00ZWU5LWEzZWMtY2UyYWFmYmY3ZWQzIiwidCI6IjBmOGQxOGNmLTBlZTgtNGIyYy1iYTJjLTZjMGQwMGRmNDNlOCIsImMiOjEwfQ%3D%3D'
			},
			{
				name: 'KTXH- DOANH NGHIỆP',
				load: false,
				url: 'https://app.powerbi.com/view?r=eyJrIjoiYmVmOGZjODktMWMwYy00M2ZlLTk4YzAtNDQwNTg4Mzc2ODA3IiwidCI6IjBmOGQxOGNmLTBlZTgtNGIyYy1iYTJjLTZjMGQwMGRmNDNlOCIsImMiOjEwfQ%3D%3D&pageName=ReportSection3ce2d34e397369071aec'
			},
			{
				name: 'Hành chính công - tình hình xử lý hồ sơ',
				load: false,
				url: 'https://app.powerbi.com/view?r=eyJrIjoiMmI5YzEyOWYtNDg4MS00MDk3LWIzNmUtMjU5ZDVmNTZkNWJiIiwidCI6IjBmOGQxOGNmLTBlZTgtNGIyYy1iYTJjLTZjMGQwMGRmNDNlOCIsImMiOjEwfQ%3D%3D'
			},
			{
				name: 'Hành chính công - Hồ sơ quá hạn trễ hạn',
				load: false,
				url: 'https://app.powerbi.com/view?r=eyJrIjoiMDNjZjAzMDgtNjQxMy00NmNkLTkxNjctMDNkY2NkODc2YmFkIiwidCI6IjBmOGQxOGNmLTBlZTgtNGIyYy1iYTJjLTZjMGQwMGRmNDNlOCIsImMiOjEwfQ%3D%3D'
			},
			
			{
				name: 'Hành chính công - Đường dây nóng',
				load: false,
				url: 'https://app.powerbi.com/view?r=eyJrIjoiMTU0MzA5NWYtNTBhYy00ZTBhLWFkNzItYmNkYjA1Y2QyNWYwIiwidCI6IjBmOGQxOGNmLTBlZTgtNGIyYy1iYTJjLTZjMGQwMGRmNDNlOCIsImMiOjEwfQ%3D%3D&pageName=ReportSectionfcadd890182b4da5edad'
			},
			{
				name: 'Y tế - Covid',
				load: false,
				url: 'https://app.powerbi.com/view?r=eyJrIjoiZDM5ZTNhMDctNWIzMi00YzIwLTk3NzEtMWJlMjYyZTkxMTdiIiwidCI6IjBmOGQxOGNmLTBlZTgtNGIyYy1iYTJjLTZjMGQwMGRmNDNlOCIsImMiOjEwfQ%3D%3D'
			},
			{
				name: 'Y tế - Thông tin y tế',
				load: false,
				url: 'https://app.powerbi.com/view?r=eyJrIjoiNDA5YjA4NmEtMGNkNy00YzNhLThiZmEtOGExZTc1YTBjZDY2IiwidCI6IjBmOGQxOGNmLTBlZTgtNGIyYy1iYTJjLTZjMGQwMGRmNDNlOCIsImMiOjEwfQ%3D%3D'
			},
			
			{
				name: 'Giáo Dục',
				load: false,
				url: 'https://app.powerbi.com/view?r=eyJrIjoiNzc3ZGRmZjktZDUzOS00NDczLWJhMDItNTg3YmIzYWE2ZTNhIiwidCI6IjBmOGQxOGNmLTBlZTgtNGIyYy1iYTJjLTZjMGQwMGRmNDNlOCIsImMiOjEwfQ%3D%3D'
			}
		]

		let slideIndex = 0;
		let slideReady = 0;

		window.addEventListener('load', function(event) {
			SLIDE.forEach(function(e, slideIndex){
					if (e.load === false) {
						loadFrame(e);
					}
				});	
		});

		function loadFrame(slide) {
			var iframe = document.createElement('iframe');
			iframe.onload = function () {
				if (slide.load === false) {
					slideReady++;
					console.log('iframe ' + slideReady + ' loaded');
					slide.load = true;
					if (slideReady === SLIDE.length) {
						// Show slide 1
						showSlide(slideIndex);
						slideIndex++;

						setInterval(function () {
							showSlide(slideIndex);
							slideIndex++;
							if (slideIndex >= SLIDE.length) { slideIndex = 0 }
						}, SECOND * 1000)
						console.log('page is fully loaded');
					}
				}
			};

			iframe.style = "height: 100%; width: 100%; position: fixed; z-index: 100; left: 0; top: 0; overflow-x: hidden; border: 0";
			iframe.className = "slide";
			iframe.src = slide.url;
			iframe.title = slide.name;
			document.getElementById('slideshow').appendChild(iframe);
		}

		function showSlide(slideIndex) {
			var i;
			var slide = document.getElementsByClassName("slide");
			for (i = 0; i < slide.length; i++) {
				slide[i].style.display = "none";
			}
			slide[slideIndex].style.display = "block";
			console.log('showing: ', slide[slideIndex].title);
			let nextRefresh = slideIndex + 2;
			if (nextRefresh >= slide.length) {
				nextRefresh -= slide.length;
			}
			console.log('refresh: ', slide[nextRefresh].title);
			slide[nextRefresh].src += '';
		}
	</script>
</body>

</html>